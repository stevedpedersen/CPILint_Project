# CPILint_Project


# CPILint Docker Image for SAP Cloud Integration

This Docker image is for running [CPILint](https://github.com/mwittrock/cpilint) to lint artifacts from SAP Cloud Integration (aka CPI), an integration service for SAP Business Technology Platform (BTP). 

It packages the CPILint runtime – including the built CPILint jar, runtime dependencies, rulesets, scripts, and necessary resources – so you can run CPILint in a consistent environment without needing the full source or build files.

The image is built from a custom Debian (stable-slim) base and uses Amazon Corretto 17. It also includes a locally provided ZScaler certificate if available. The image is tagged using a strategy (e.g. “latest” on main branches, “rc” on release candidates) as defined in the container.yaml.

## Getting Started

### Local Build Project Structure

Before running the Docker build command, ensure you have the following submodules and files in your working directory:

```bash
├───cpilint
│   └───docker-release
│       └───cpilint-1.0.5-docker.zip    # generated by running: ant docker-release in the cpilint submodule
├───jpm_shared_lib
│   └───_scm_container
│       └───cpilint
│           └───Dockerfile              # copy this Dockerfile to the project root if needed
├───ZscalerRootCA.crt                   # place a copy at the project root (used for local CA import)
└───Dockerfile                          # copied version from jpm_shared_lib/_scm_container/cpilint/
```

### Building Locally

1. **Prepare the Release Artifact:**  
In the cpilint submodule, run the docker-release target:
```bash
ant docker-release
```

2. **Build the Docker Image + Tag + Push:**  
```bash
docker build --no-cache -t jeas-docker-local.artifactrepo.jnj.com:443/cpilint:1.0.5-temurin-06 . 
docker tag jeas-docker-local.artifactrepo.jnj.com:443/cpilint:1.0.5-temurin-06 jeas-docker-local.artifactrepo.jnj.com:443/cpilint:latest
docker tag jeas-docker-local.artifactrepo.jnj.com:443/cpilint:1.0.5-temurin-06 jeas-docker-local.artifactrepo.jnj.com:443/cpilint
docker push -a jeas-docker-local.artifactrepo.jnj.com:443/cpilint
```

**To use the CPILint image without rebuilding, pull it from Artifactory:**
```bash
docker pull jeas-docker-local.artifactrepo.jnj.com:443/cpilint:latest
docker run --rm jeas-docker-local.artifactrepo.jnj.com:443/cpilint:latest [options]
```

---

### How to Build the Docker Image with Jenkins Pipeline Manager (JPM)

Automatically built.

---


.\scripts\cpilint.bat -skipvercheck -debug -boring -output json -rules rulesets\default.xml -key .env.json

.\scripts\cpilint.bat -skipvercheck -debug -boring -output json -rules rulesets\default.xml  -f SP_IF_Sandbox.zip

.\scripts\cpilint.bat -skipvercheck -debug -boring -rules rulesets\default.xml  -f SP_IF_Sandbox.zip

.\scripts\cpilint.bat -skipvercheck -debug -boring -rules rulesets\default.xml -f SP_IF_Sandbox.zip


.\scripts\cpilint.bat -skipvercheck -debug -rules rulesets\default.xml -unpacked-files resources\iflow-example-unzipped

cpilint -rules <file> -unpacked-files


2. **Build the Docker Image + Tag + Push:**  
```bash
docker build --no-cache -t jeas-docker-local.artifactrepo.jnj.com:443/cpilint:1.0.5-openjdk . 
docker tag jeas-docker-local.artifactrepo.jnj.com:443/cpilint:1.0.5-openjdk jeas-docker-local.artifactrepo.jnj.com:443/cpilint:latest
docker tag jeas-docker-local.artifactrepo.jnj.com:443/cpilint:1.0.5-openjdk jeas-docker-local.artifactrepo.jnj.com:443/cpilint
docker push -a jeas-docker-local.artifactrepo.jnj.com:443/cpilint
```